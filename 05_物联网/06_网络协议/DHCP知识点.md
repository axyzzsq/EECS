# DHCP知识点

(Dynamic Host Configuration Protocol, 动态主机配置协议)是一个局域网的网络协议，使用UDP协议 工作。DHCP协议采用UDP作为传输协议，主机发送请求消息到DHCP服务器的67号端口，DHCP服务器回应应答消息给客户端的68号端口

## 主要有两个用途:

- 给内部网络或网络服务供应商自动分配IP地址给用户
- 内部网络管理员作为对所有计算机作中央管理的手段

## 使用DHCP的好处：

1. 减少管理员的工作量 
2. 避免输入错误的可能
3. 避免IP地址冲突当更改IP地址段时，不需要重新配置每个用户的IP地址 
4. 提高了IP地址的利用率 
5. 方便客户端的配置

## DHCP的典型应用模式如下:

在网络中架设一-台专用的DHCP服务器，负责集中分配各种网络地址参数(主要包括IP地址、子网掩码、广播地址、默认网关地址、DNS服 务器地址) ;其他主机作为DHCP客户机，将网卡配置为自动获取地址，即可与DHCP服务器进行通信，完成自动配置过程。

## DHCP的IP地址自动获取工作原理:

第一步:客户端在网络中搜索服务器。 客户端通过广播发送DHCP Discover报文寻找服务器端

第二步:服务器向客户端响应服务。服务器端通过单播发送DHCP Offer报文向客户端提供IP地址等网络信息，从IP地址池中挑选一个尚未分配的IP地址分配给客户端

第三步:客户端向服务器发出服务请求。如果有多台DHCP服务器向该客户端发来DHcP-offer报文，客户端只接受第一个收到的DHCP-offer报文并提取Ie地址，然后客户端通过广播发送DHCP Request报文告知服务器端本地选择使用该IP地址

第四步:服务器向客户端提供服务。服务器通过单播发送DHCP Ack报文告知客户端IP地址是合法可用的，并在选项字段中增加IP地址的使用租期信息

第五步:重新登录 DHCP客户机每次重新登录网络时，不需要再发送 DECP Discover信息，而是直接发送包含前一次所分配的地址的DHCP Request请求信息。

第六步:更新租约 当DHCP服务器向客户机出租的IP地址租期达到50%时，就需要更新租约。客户机直接向提供租约的服务器发送DHCP Request包，要求更新现有的地址租约。


 ![img](https://pic-1304959529.cos.ap-guangzhou.myqcloud.com/DB/202209151507543.png)