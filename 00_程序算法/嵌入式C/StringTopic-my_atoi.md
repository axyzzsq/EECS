# my_atoi

## 一、Usage

`atoi` 是一个常用的C语言函数，用于将字符串转换为整数（ASCII to integer）。`atoi` 函数的原型如下：

```c
int atoi(const char *str);
```

函数接受一个指向以 null 结尾的字符串的指针，然后尝试将该字符串转换为一个整数并返回结果。字符串可以包含可选的前导空格字符（如空格、制表符或换行符）、可选的正负号以及数字字符。如果字符串无法转换为有效的整数，则 `atoi` 函数将返回0。

以下是 `atoi` 函数的基本工作原理：

1. 首先，`atoi` 函数会跳过字符串中的前导空格字符，直到找到第一个非空格字符。
2. 如果第一个非空格字符是正号或负号，则 `atoi` 函数会相应地设置一个标志来表示正负号，并将指针向后移动一位。
3. `atoi` 函数会继续解析剩余的字符，直到遇到非数字字符为止。它将每个字符解释为数字，并将其累积到结果中。
4. 如果字符串无法转换为有效的整数（例如，字符串为空或不包含有效的数字字符），则 `atoi` 函数将返回0。
5. 如果字符串可以成功转换为整数，则根据标志来确定结果的正负，并将其作为函数的返回值。

以下是 `atoi` 函数的示例用法：

```c
#include <stdio.h>
#include <stdlib.h>

int main() 
{
    const char *str = "12345";
    int num = atoi(str);
    printf("The converted integer is: %d\n", num);
    return 0;
}
```

上述代码将输出:

![image-20230625221123993](https://pic-1304959529.cos.ap-guangzhou.myqcloud.com/DB/image-20230625221123993.png)

需要注意的是，`atoi` 函数在处理超出整数范围的情况时是不安全的，因为它不提供错误处理机制。如果需要更强大和灵活的字符串转换函数，可以考虑使用 `strtol` 或其他类似函数。



## 二、my_atoi

### 方法1：迭代计算

```C
#include <stdio.h>

// 自定义的字符串转整数函数
int my_atoi(const char *str) 
{
    int result = 0;     // 结果变量，用于存储转换后的整数值
    int sign = 1;       // 符号标志，表示正数或负数
    int i = 0;          // 循环计数器

    if (str[i] == '-') 
    {
        sign = -1;      // 如果字符串以负号开头，则设置符号标志为负数，并将计数器加一
        i++;
    }

    // 通过循环遍历字符串的每个字符，将其转换为整数并累加到结果变量中
    for (; str[i] != '\0'; ++i) 
    {
        result = result * 10 + (str[i] - '0');   // 将当前字符转换为数字，并乘以10后与结果相加
    }

    return sign * result;   // 返回最终的整数结果，考虑符号标志
}

int main() 
{
    const char *str = "-12345";    // 待转换的字符串
    int num = my_atoi(str);        // 调用自定义的字符串转整数函数
    printf("The converted integer is: %d\n", num);   // 打印转换后的整数结果
    return 0;
}

```

-  `(str[i] - '0')`的含义

  在C语言中，字符类型是用ASCII编码表示的。ASCII编码是一种将字符映射到整数的标准编码方式。字符 `'0'` 的ASCII码值是一个整数，用来表示数字字符 0。

  当我们需要将数字字符转换为对应的整数值时，可以利用ASCII码值的性质。由于数字字符的连续排列，可以通过将字符的ASCII码值减去字符 `'0'` 的ASCII码值，得到对应的整数值。

  例如，字符 `'3'` 的ASCII码值是 51，字符 `'0'` 的ASCII码值是 48。通过计算 `str[i] - '0'`，我们得到的结果就是 3，表示字符 `'3'` 所代表的整数。

  因此，在 `my_atoi` 函数中，表达式 `(str[i] - '0')` 的作用是将字符数字转换为对应的整数值。这样做可以实现将字符串表示的数字转换为整数的功能。