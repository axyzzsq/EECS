# static关键字

## 1、static变量

> ### ①局部变量
>
> 普通局部变量是再熟悉不过的变量了，在任何一个函数内部定义的变量（不加static修饰符）都属于这个范畴。编译器一般不对普通局部变量进行初始化，也就是说它的值在初始时是不确定的，除非对其显式赋值。
>
> ```
> 普通局部变量存储于进程栈空间，使用完毕会立即释放。
> ```
>
> 静态局部变量使用static修饰符定义，即使在声明时未赋初值，编译器也会把它初始化为0。且静态局部变量存储于进程的全局数据区，即使函数返回，它的值也会保持不变。
>
> ```
> 变量在全局数据区分配内存空间；编译器自动对其初始化
> 其作用域为局部作用域，当定义它的函数结束时，其作用域随之结束
> ```
>
> *例程*
>
> ```C
> #include <stdio.h>
> 
> void fn(void)
> {
>     int n = 10;
> 
>     printf("n=%d\n", n);
>     n++;
>     printf("n++=%d\n", n);
> }
> 
> void fn_static(void)
> {
>     static int n = 10;
> 
>     printf("static n=%d\n", n);
>     n++;
>     printf("n++=%d\n", n);
> }
> 
> int main(void)
> {
>     fn();
>     printf("--------------------\n");
>     fn_static();
>     printf("--------------------\n");
>     fn();
>     printf("--------------------\n");
>     fn_static();
> 
>     return 0;
> }
> 
> ```
>
> 运行结果如下：
>
>  ![](https://pic-1304959529.cos.ap-guangzhou.myqcloud.com/DB/20220326185907.png)
>
> ### ②全局变量
>
> 全局变量定义在函数体外部，在全局数据区分配存储空间，**且编译器会自动对其初始化**。
>
> 普通全局变量对整个工程可见，其他文件可以使用extern外部声明后直接使用。也就是说其他文件不能再定义一个与其相同名字的变量了（否则编译器会认为它们是同一个变量）。
>
> 静态全局变量仅对当前文件可见，其他文件不可访问，其他文件可以定义与其同名的变量，两者互不影响。
>
> ```
> 在定义不需要与其他文件共享的全局变量时，加上static关键字能够有效地降低程序模块之间的耦合，避免不同文件同名变量的冲突，且不会误使用。
> ```
>
> 

## 2、static函数

> - 静态函数只能在声明它的文件中可见，其他文件不能引用该函数
>
> - 不同的文件可以使用相同名字的静态函数，互不影响
>
>   ```
>   非静态函数可以在另一个文件中直接引用，甚至不必使用extern声明
>   ```



## 总结

*static是一个很有用的关键字，使用得当可以使程序锦上添花。当然，有的公司编码规范明确规定只用于本文件的函数要全部使用static关键字声明，这是一个良好的编码风格。*

*无论如何，要在实际编码时注意自己的编码习惯，尽量体现出语言本身的优雅和编码者的编码素质。*

