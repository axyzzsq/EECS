# 模拟量和数字量

## 模拟转数字

### 数学模型

​        用米尺测量茶杯的高度。需要几个要素：

1. 实际存在的茶杯（10厘米）

2. 参考标准：米尺

3. 米尺的1/n和茶杯进行比较(ADC将参考电压按照位深进行等分与输入电压比较)

    ![](https://pic-1304959529.cos.ap-guangzhou.myqcloud.com/DB/20220326193635.png)

4. 完成比较之后，输出数字量。

   （在设置51单片机的IO口模式时，从普通IＯ模式切换到AD采集模式，要注意寄存器是否支持位寻址，如果不支持位寻址，就需要一次操作八位寄存器。）

    ![](https://pic-1304959529.cos.ap-guangzhou.myqcloud.com/DB/20220326193638.png)

   计算来源：

   10 bit位深，从1/1024开始逼近进行比较，这个工作由ADC模块去做，当第X次时，ADC判定比较完成，此时,(Vcc/1024)*x = Vin
   $$
   (Vcc\div1024)\times x = Vin
   $$

   $$
   x = 1024 \times Vin\div Vcc
   $$

### 编码流程

1. 初始化
2. 查询ADC_FLAG(软件复位，硬件置位)  ===> 完成ADC转换之后ADC_FLAG自动置1，触发中断读取ADC转换数值。
3. ADC_START(软件置位，硬件复位)  ===>  完成ADC转换之后，硬件会自动把这个标志位置0，如果要再次采样，需要软件重新置位。
4. 读ADC_RES

***总结***：<u>ADC就是输入模拟量和参考电压作比较，比完了输出一个数字量。</u>



## 数字转模拟

 ![](https://pic-1304959529.cos.ap-guangzhou.myqcloud.com/DB/20220326193641.png)





